---
layout: default
title: Methods
---

<div class="jumbotron">
    <h2>Studying of activity pattern</h2>
    
    <p>
        <a href="../tracking">Video tracking</a> of land snails resulted in recordings of positional and morphological features
        of 35 snails, every minute for 140 hours. This page describes how activity was defined and
        shows graphical description of overall activity to guide an in-depth statistical analysis.
        It explains how several binomial generalised linear mixed models of activity were assessed.
        Finally, it describes the effect of variables such as time, species and age on the propensity to be active.
    <p>
        The entire statistical analysis was done using R programming language,
        in combination with <a href="http://cran.r-project.org/web/packages/lme4/index.html">lme4</a> package.
    </p>
    </p>
    
    </div>
<div class="row">
	<div class="col-md-12 dag_div" >
			<svg 
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="900"
   height="200"
   id="dag"
   version="1.1"
   inkscape:version="0.48.4 r9939"
   sodipodi:docname="untitled.svg">
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.7"
     inkscape:cx="-0.77253513"
     inkscape:cy="393.6823"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="false"
     inkscape:window-width="1920"
     inkscape:window-height="1014"
     inkscape:window-x="0"
     inkscape:window-y="27"
     inkscape:window-maximized="1" />
  <defs
     id="defs4">
    <marker
       inkscape:stockid="Arrow2Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow2Mend"
       style="overflow:visible">
      <path
         id="path4058"
         style="fill-rule:evenodd;stroke-width:0.625;stroke-linejoin:round"
         d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z"
         transform="scale(-0.6,-0.6)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow2MendTransp"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow2MendTransp"
       style="overflow:visible">
      <path
         id="path7"
         style="fill-opacity:0.5;fill-rule:evenodd;stroke-width:0.625;stroke-linejoin:round"
         d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z"
         transform="scale(-0.6,-0.6)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow2MendTransp5"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow2MendTransp5"
       style="overflow:visible">
      <path
         id="path3089"
         style="fill:#000000;fill-opacity:0.5;fill-rule:evenodd;stroke:#000000;stroke-width:0.625;stroke-linejoin:round"
         d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z"
         transform="scale(-0.6,-0.6)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow2Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow2Mend-6"
       style="overflow:visible">
      <path
         id="path4058-8"
         style="fill-rule:evenodd;stroke-width:0.625;stroke-linejoin:round"
         d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z"
         transform="scale(-0.6,-0.6)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow2MendX"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow2MendX"
       style="overflow:visible">
      <path
         id="path4007"
         style="fill:#808080;fill-rule:evenodd;stroke:#808080;stroke-width:0.625;stroke-linejoin:round"
         d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z"
         transform="scale(-0.6,-0.6)"
         inkscape:connector-curvature="0" />
    </marker>
  </defs>
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(0,-852.36218)">
    <a
       xlink:href="../tracking#features"
       transform="translate(-84.603565,448.44362)"
       id="a12"><text
   xml:space="preserve"
   style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;letter-spacing:0px;word-spacing:0px;text-anchor:middle;fill:#000000;fill-opacity:0.5;stroke:none;font-family:Liberation Sans;-inkscape-font-specification:Liberation Sans"
   x="143.25868"
   y="509.47592"
   id="text3799"
   sodipodi:linespacing="100%"><tspan
     sodipodi:role="line"
     x="143.25868"
     y="509.47592"
     id="tspan3803">Features</tspan></text>



						 &gt;
						 </a>
    <text
       xml:space="preserve"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;letter-spacing:0px;word-spacing:0px;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;font-family:Liberation Sans;-inkscape-font-specification:Liberation Sans"
       x="247.34053"
       y="955.62885"
       id="text3799-4"
       sodipodi:linespacing="100%"><tspan
         sodipodi:role="line"
         x="247.34053"
         y="955.62885"
         id="tspan3803-7">Pre-processing</tspan></text>
    <a
       xlink:href="#activity"
       id="a31"
       transform="matrix(1.0680402,0,0,1.0680402,90.922431,323.5696)">
      <rect
         id="dag_activity"
         class="process"
         style="stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         width="157.47005"
         height="42.82719"
         x="67.336403"
         y="564.90448" />
    </a>
    <text
       xml:space="preserve"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;letter-spacing:0px;word-spacing:0px;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;font-family:Liberation Sans;-inkscape-font-specification:Liberation Sans"
       x="617.63336"
       y="943.98596"
       id="text3799-837"
       sodipodi:linespacing="100%"><tspan
         sodipodi:role="line"
         x="617.63336"
         y="943.98596"
         id="tspan4045">Model</tspan><tspan
         sodipodi:role="line"
         x="617.63336"
         y="967.98596"
         id="tspan4049">Comparison</tspan></text>
    <a
       xlink:href="#models"
       id="a34"
       transform="matrix(1.204955,0,0,1.204955,371.3457,-60.25639)">
      <rect
         id="dag_models"
         class="process"
         style="stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         width="116.38619"
         height="51.066738"
         x="146.05673"
         y="812.70312" />
    </a>
    <text
       xml:space="preserve"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;letter-spacing:0px;word-spacing:0px;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;font-family:Liberation Sans;-inkscape-font-specification:Liberation Sans"
       x="815.82733"
       y="922.35901"
       id="text3799-7"
       sodipodi:linespacing="100%"><tspan
         sodipodi:role="line"
         x="815.82733"
         y="922.35901"
         id="tspan3803-80" /><tspan
         sodipodi:role="line"
         x="815.82733"
         y="946.35901"
         id="tspan3931">Model</tspan><tspan
         sodipodi:role="line"
         x="815.82733"
         y="970.35901"
         id="tspan4053">Conclusions</tspan></text>
    <a
       xlink:href="#conclusion"
       id="a37"
       transform="matrix(1.21513,0,0,1.0863425,567.81302,-60.13541)">
      <rect
         id="dag_conclusion"
         class="process"
         style="stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         width="116.4709"
         height="49.636227"
         x="146.01437"
         y="904.83002" />
    </a>
    <path
       style="fill:none;stroke:#000000;stroke-width:2.29999995;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow2Mend)"
       d="m 702.32856,949.80296 26.26396,0"
       id="path4025-98"
       inkscape:connector-curvature="0" />
    <text
       xml:space="preserve"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;letter-spacing:0px;word-spacing:0px;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;font-family:Liberation Sans;-inkscape-font-specification:Liberation Sans"
       x="437.27325"
       y="915.67462"
       id="text3799-9"
       sodipodi:linespacing="100%"><tspan
         sodipodi:role="line"
         x="437.27325"
         y="915.67462"
         id="tspan3915">Summary</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;letter-spacing:0px;word-spacing:0px;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;font-family:Liberation Sans;-inkscape-font-specification:Liberation Sans"
       x="438.21283"
       y="988.68549"
       id="text3799-8"
       sodipodi:linespacing="100%"><tspan
         sodipodi:role="line"
         x="441.54095"
         y="988.68549"
         id="tspan3919">Binomial </tspan><tspan
         id="tspan4017"
         sodipodi:role="line"
         x="438.21283"
         y="1012.6855">GLMMs</tspan></text>
    <a
       xlink:href="#summary"
       id="a41"
       transform="translate(376.00903,245.60562)">
      <rect
         id="dag_summary"
         class="process"
         style="stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         width="116.65207"
         height="51.652069"
         x="3.4596794"
         y="638.35431" />
    </a>
    <a
       xlink:href="#glmms"
       id="a44"
       transform="translate(234.94738,324.89134)">
      <rect
         id="dag_glmms"
         class="process"
         style="stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         width="119.45699"
         height="57.314125"
         x="144.52133"
         y="638.55896" />
    </a>
    <path
       style="fill:none;stroke:#000000;stroke-width:2.29999995;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow2Mend)"
       d="m 345.77566,936.75327 17.9896,-19.13555"
       id="path4025-3-5"
       inkscape:connector-curvature="0" />
    <path
       style="fill:none;stroke:#000000;stroke-width:2.29999995;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow2Mend)"
       d="m 345.77566,960.84925 17.98961,19.13555"
       id="path4025-3-1"
       inkscape:connector-curvature="0" />
    <path
       style="fill:none;stroke:#000000;stroke-width:2.29999995;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow2Mend)"
       d="m 513.67665,1002.2174 17.9896,-19.13559"
       id="path4025-3-5-5"
       inkscape:connector-curvature="0" />
    <path
       style="fill:#808080;stroke:#808080;stroke-width:2.29999995;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow2MendX)"
       d="m 116.67357,949.80297 26.26396,0"
       id="path4025-98-5"
       inkscape:connector-curvature="0" />
  </g>
</svg>

	</div>
		
    <div class="row fig_div hidden" style= "display: none;"></div>
    
    <div class="row math_div" id="math">
        <div id="math_activity" class= "process">
        <div class="row">
            <div class="col-md-6">        
                <h2>Pre-procecessing</h2>
                <p>
                Minor preprocessing was applied to the data resulting from the tracking pipeline.
                <ol>
                    <li>The first two hours of both experiments were removed to account for behavioural habituation of the animals.</li>
                    <li>Median filter (with a window size of 3 minutes) was applied in order to remove potential outlier points.</li>
                    <li>Linear interpolation was applied to replace the few missing points (where the algorithm could not detect the animal).
                    This also guaranteed the time series of features to be homogeneous.</li>
                    <li>Distance between consecutive $\{x,y\}$ positions was trivially computed:</li>
                </ol>
                
                </p>
                <figure> <img src="../img/speed.png"></img>
                <figcaption><em>Instantaneous speed over time for one individual.</em>
                Each point represents an instantaneous speed at a given minute for a
                 representative animal.
                The grey and black stripes on the x axis represent artificial
                 day and night, respectively.
                The red horizontal line represents the arbitrary threshold of activity used ($1mm/min$).
                </figcaption></figure>
            </div>
            <div class="col-md-6">
                <h2>Activity</h2>
                <p>
                Instead of using speed as a measure of activity,
                we were interested in defining a binary response variable that could be a conceptual approximation
                of whether an animal is asleep at a time $t$.
                This is an important difference, because we are more interested in the resting state of an animal
                than in its overall speed.
                For this reason, a snail was considered active at a given time if and only if its
                instantaneous speed was higher than $1mm/min$ (see red line on the figure).
                This is a provisional approximation which should
                be taken with caution (<a href=" ../discussion/">see discussion</a>).
                </p>
                <figure> <img src="../img/activity_one_animal.png"></img>
                <figcaption><em>Average activity per hour.</em>
                Each point represents the proportion of time during which a representative animal was active each hour of the experiment.
                The grey and black stripes on the x axis represent artificial day and night,
                respectively.
                </figcaption></figure>
            </div>
        </div>
        </div>
        
        
        
    <div class="row math_div" id="math">
        <div id="math_conclusion" class= "process">
        <div class="row">
            <div class="col-md-6">        
                <h2>Model Coefficients and bootstrap confidence intervals</h2>
                <p>
                The Maximum likelihood estimates of the coefficients of the best models were computed.
                In addition, bootstrap replicates were performed by refitting the model on random samples of the
                original data.
                
                </p>
                <figure>
        
	<table cellspacing="0" border="0" style="margin:auto">
	<colgroup width="227"></colgroup>
	<colgroup span="4" width="85"></colgroup>
	<tr>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left"><br></td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" sdnum="2057;0;0.00E+00">Estimate</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" sdnum="2057;0;0.00E+00">std</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left" sdnum="2057;0;0.00E+00">P-value</td>
		<td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">significance</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">(Intercept)</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.895" sdnum="2057;0;0.00E+00">-8.95E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="1.002" sdnum="2057;0;0.00E+00">1.00E+00</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.371917" sdnum="2057;0;0.00E+00">3.72E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left"><br></td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">is_day</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.556" sdnum="2057;0;0.00E+00">5.56E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.2061" sdnum="2057;0;0.00E+00">2.06E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.006971" sdnum="2057;0;0.00E+00">6.97E-03</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">**</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">Age</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.01275" sdnum="2057;0;0.00E+00">1.28E-02</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.4132" sdnum="2057;0;0.00E+00">4.13E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.975392" sdnum="2057;0;0.00E+00">9.75E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left"><br></td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">time</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.0001212" sdnum="2057;0;0.00E+00">-1.21E-04</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.00002756" sdnum="2057;0;0.00E+00">2.76E-05</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.000011" sdnum="2057;0;0.00E+00">1.10E-05</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">SpeciesH_a</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="1.578" sdnum="2057;0;0.00E+00">1.58E+00</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="1.31" sdnum="2057;0;0.00E+00">1.31E+00</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.228403" sdnum="2057;0;0.00E+00">2.28E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left"><br></td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">is_day:Age</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.9372" sdnum="2057;0;0.00E+00">-9.37E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.08777" sdnum="2057;0;0.00E+00">8.78E-02</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="2E-016" sdnum="2057;0;0.00E+00">2.00E-16</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">is_day:time</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.0008139" sdnum="2057;0;0.00E+00">-8.14E-04</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.00006922" sdnum="2057;0;0.00E+00">6.92E-05</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="2E-016" sdnum="2057;0;0.00E+00">2.00E-16</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">Age:time</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.0001768" sdnum="2057;0;0.00E+00">-1.77E-04</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.00001242" sdnum="2057;0;0.00E+00">1.24E-05</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="2E-016" sdnum="2057;0;0.00E+00">2.00E-16</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">is_day:SpeciesH_a</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.9287" sdnum="2057;0;0.00E+00">-9.29E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.2441" sdnum="2057;0;0.00E+00">2.44E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.000142" sdnum="2057;0;0.00E+00">1.42E-04</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">Age:SpeciesH_a</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.9561" sdnum="2057;0;0.00E+00">-9.56E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.6393" sdnum="2057;0;0.00E+00">6.39E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.134774" sdnum="2057;0;0.00E+00">1.35E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left"><br></td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">time:SpeciesH_a</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.0007321" sdnum="2057;0;0.00E+00">-7.32E-04</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.00003486" sdnum="2057;0;0.00E+00">3.49E-05</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="2E-016" sdnum="2057;0;0.00E+00">2.00E-16</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">is_day:Age:time</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.0003851" sdnum="2057;0;0.00E+00">3.85E-04</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.00002807" sdnum="2057;0;0.00E+00">2.81E-05</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="2E-016" sdnum="2057;0;0.00E+00">2.00E-16</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">is_day:Age:SpeciesH_a</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.251" sdnum="2057;0;0.00E+00">2.51E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.1183" sdnum="2057;0;0.00E+00">1.18E-01</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.033887" sdnum="2057;0;0.00E+00">3.39E-02</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">*</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">is_day:time:SpeciesH_a</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.0006549" sdnum="2057;0;0.00E+00">6.55E-04</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.00008171" sdnum="2057;0;0.00E+00">8.17E-05</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="1.1E-015" sdnum="2057;0;0.00E+00">1.10E-15</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">Age:time:SpeciesH_a</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.0003783" sdnum="2057;0;0.00E+00">3.78E-04</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.00001685" sdnum="2057;0;0.00E+00">1.69E-05</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="2E-016" sdnum="2057;0;0.00E+00">2.00E-16</td>
		<td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
	<tr>
		<td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">is_day:Age:time:SpeciesH_a</td>
		<td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="-0.0002349" sdnum="2057;0;0.00E+00">-2.35E-04</td>
		<td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.00003593" sdnum="2057;0;0.00E+00">3.59E-05</td>
		<td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="0.0000000000615" sdnum="2057;0;0.00E+00">6.15E-11</td>
		<td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="left">***</td>
	</tr>
</table>
                <figcaption><em>Coefficient estimates for the best model.</em>
                P-value are computed Wald Z statistics, which is suboptimal (see <a href="http://glmm.wikidot.com/faq">here</a>).
                It would have been preferable to perform parametric bootstrap confidence interval, but this could not be done because of time constraints.
                ":" symbol indicate intaction indication. "H_a" (<em>Helix aspersa</em>) is the second level of the variable "Species".
                Significance code: ***, P < 0.001; **, P < 0.01; *, P < 0.05.
                </figcaption>
                </figure>
               <p>
                Activity decreases dramatically with time.
               It seems that after a long enough time, all individual are inactive. This probably reduces the effect of individual predictors in favour of interaction terms with time.
               In other words, the very strong  effect of time seems to mask other individual predictors.
               For instance, if there were a large difference in activity between species, but after two days both species were inactive for four days, most of the effect would be interaction terms.
               This is probably why we have no effect of species on its own, but a very strong interaction between species and time (H_a individuals seemingly reducing their activity faster).
               The same conclusion could be drawn for Age. This is also likely to be why the model with all interaction terms had a larger predictive power.
               </p>
               
                 <p>
                In the same maner, daylight (is_day) has only a moderate effect on its own. This i because most of the effect is captured by the interaction with the time of the experiment.
                For instance, in the first day of the experiment daylight has a very large effect, whislt it has almost none after 6 days.
               </p>
            </div>
            <div class="col-md-6">
                <h2>Effect of time and species</h2>
                
                <figure> <img src="../img/activity_vs_sptime.png"></img>
                <figcaption><em>Effect of time and night on activities for both species</em>
                Each points represents an average value of activity over an hour for all individual of a species.
                Importantly, the model is fited on the raw, binary data, not on those points, which are only for graphical convenience.
                Red and blue indicate <em>Cepaea nemoralis</em> and <em>Helix aspersa</em>, respectively.
                Grey and black stripes indicate artificial day and night, respectively.
                Bootstrap confidence intervas l could not be computed in time.

                </figcaption></figure>
               
			   <h2>Effect of time and age</h2>
                <figure> <img src="../img/activity_vs_agetime.png"></img>
                <figcaption><em>Effect of time and night on activities for both species</em>
                Each points represents an average value of activity over an hour for all individual of a different age.
                Importantly, the model is fited on the raw, binary data, not on those points, which are only for graphical convenience.
                Grey and black stripes indicate artificial day and night, respectively.
                Bootstrap confidence intervas l could not be computed in time.
                </figcaption></figure>
                
            </div>
        </div>	
        </div>
        
        
        <div id="math_summary" class= "process">
        <div class="row">
            <div class="col-md-6">    
            <h2>Activity seems to decrease during the experiment</h2>
            <p>
                When pooling all animals and computing the average activity ratio for each hour of the experiment,
                it appears that:
                <ol>
                    <li>There is a very large proportion of inactivity (rarely more than 20% of animals are active).</li>
                    <li>Activity seems to decrease during experiment.</li>
                </ol>
                
                <figure> <img src="../img/activity_all_animals.png"></img>
                <figcaption><em>Average activity per hour for all animals.</em>
                Overall average of activity for all animal and every hour of both experiments.
                The grey and black stripes on the x axis represent artificial day and night, respectively.
                </figcaption></figure>
                
            </p>


            </div>
            <div class="col-md-6">    
            <h2>Snails appear to be nocturnal</h2>
            <p>
                When looking at the overall pattern, snails appear to be more active during night.
                This result indicates that our experimental condition may be sufficient to promote
                differential activities between day and night.
                
                <figure> <img src="../img/zeitgeber_activ.png"></img>
                <figcaption><em>Overall average activity at different time of the day.</em>
                The overall activity was aggregated, for all animals and over time,
                for every hour, relative to the onset of the night.
                The time  $t=0$ represents the onset of the night, and $t=12$, the onset of the day.
                </figcaption></figure>
                
            </p>

            </div>
        </div>
        </div>
        
        <div id="math_glmms" class= "process">
        <div class="row">
            <div class="col-md-6">    
            <h2>Binomial response variable</h2>
            <p>
            The response variable, activity, is here assumed to be a random variable $Y$ with
             binary outcome (active or not active).
            Therefore, the linear framework, which assumes $Y$  to be normally distributed,
             cannot be used.
            However, it is possible to model $Y$ in with a <em>generalised linear model</em>, 
            with a binomial distribution, and perform a logistic regression.
            </p>
            
            <h2>Pseudo-replication</h2>
            <p>
            Each successive measurement on a single snail is <em>not independent</em> from other measurement on the same animal.
            A simplified data frame could look like:
            <figure>
            <table cellspacing="0" border="0" style="margin:auto">
                <colgroup span="3" width="85"></colgroup>
                <tr>
                    <td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center"><b>Activity</b></td>
                    <td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center"><b>time</b></td>
                    <td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center"><b>Snail</b></td>
                </tr>
                <tr>
                    <td style="border-top: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="1" sdnum="2057;">1</td>
                    <td style="border-top: 1px solid #000000" align="center" sdval="1" sdnum="2057;">1</td>
                    <td style="border-top: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">A</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="0" sdnum="2057;">0</td>
                    <td align="center" sdval="2" sdnum="2057;">2</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">A</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="1" sdnum="2057;">1</td>
                    <td align="center" sdval="3" sdnum="2057;">3</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">A</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="1" sdnum="2057;">1</td>
                    <td align="center" sdval="4" sdnum="2057;">4</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">A</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="1" sdnum="2057;">1</td>
                    <td align="center" sdval="5" sdnum="2057;">5</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">A</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center">…</td>
                    <td align="center">…</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">…</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="1" sdnum="2057;">1</td>
                    <td align="center" sdval="1" sdnum="2057;">1</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">B</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="0" sdnum="2057;">0</td>
                    <td align="center" sdval="2" sdnum="2057;">2</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">B</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="1" sdnum="2057;">1</td>
                    <td align="center" sdval="3" sdnum="2057;">3</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">B</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="1" sdnum="2057;">1</td>
                    <td align="center" sdval="4" sdnum="2057;">4</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">B</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center" sdval="1" sdnum="2057;">1</td>
                    <td align="center" sdval="5" sdnum="2057;">5</td>
                    <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">B</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="center">…</td>
                    <td style="border-bottom: 1px solid #000000" align="center">…</td>
                    <td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="center">…</td>
                </tr>
            </table>
            </figure>
            </p>
            <p>
            It would be wrong to ignore the (random) effect between each measurement of an animal and only model fixed effects.
            The analysis of time series is not trivial, but one way to address this issue is to use
            <em>mixed model</em> and set every individual snail as a random effect.
            For instance, in R, a model could be formulated like:
{% highlight R %}
R> Activity ~ time + (1 | Snail)
{% endhighlight %}
<!--
            In mathematical terms, this model could be formulated as:
            $$Y(t) = \frac{1}{1 + e^{-\beta_0 + \beta_1t}} + \epsilon_t$$
            Where: $\beta_0$ and $\beta_1$ are coefficients, and $\epsilon$ is a random variable.
            If we have multiple predictor variables, we can write this in a matrix notation:
            $$Y = \frac{1}{1 + e^{-\beta_0 + \beta_1\mathbf{X}}} + \epsilon_t$$
            Where $\mathbf{X}$ is a matrix of $n$ predictors by $m$ observations.
            $\beta_1$ is a vector of coefficients.
-->
            </p>
            
            </div>
            <div class="col-md-6">    
            <h2>Nested Random Effects</h2>
            <p>
            In this experiment, there are, in fact, two levels of random effects.
            Indeed, two replicates (blocks) of the experiments have been produced,
            but each individual snail is only represented in one block.
            Blocks themselves may have an (random) effect.
            It is possible to account for this nestedness using hierarchical model:
{% highlight R %}
R> Activity ~ time + (1 | Experiment/Snail)
{% endhighlight %}
            However, it is sometimes recommended to collapse top level random effects (block)
             when the level of factor is low (see
             <a href="http://www.sciencedirect.com/science/article/pii/S0169534709000196"> B. M.
             Bolker et al. 2008</a>).
            </p>
            
        </div>
        </div>
        </div>
<div id="math_models" class= "process">
        <div class="row">
            <div class="col-md-6">    
            <h2>The models</h2>
            <p>
            The interspersed experimental design allows us to consider several independent ($X$) variable in order to explain the
            response variable ($Y$).
            In the present study, we will consider the effect of the animal <em>age</em>, <em>species</em>,
            whether the observation was during the <em>day or the night</em> and the <em>time</em> elapsed since the start of the experiment.
            
            Therefore, we can formulate different combinations of fixed effects. For example:
            
{% highlight python %}
R> Activity ~ time + RANDOM_EFFECT
R> Activity ~ time * is_day + RANDOM_EFFECT
R> Activity ~ time + is_day * Species + RANDOM_EFFECT
R> Activity ~ time * is_day + Species * Age + RANDOM_EFFECT
...
{% endhighlight %}
In addition, one can collapse the block random effect or not:
{% highlight R %}
R> Activity ~ FIXED_EFFECT + (1 | experiment/snail)
R> Activity ~ FIXED_EFFECT + (1 | snail)
{% endhighlight %}

            </div>
            <div class="col-md-6">    

            <h2>Assessing models</h2>
            <p>
            Models for all possible combinations of the four (or less) variables and the
            two fixed effects were fitted
            Computing likelihood with Laplace approximation.
            
            The predictive power of each model was then assessed by the Akaike Information Criterion (AIC).
            Interestingly, models with nested random effects systematically yielded 
            higher (worse) AIC, by several points,
            than their non-nested counterparts.
            Therefore, the simple (non-hierarchical) random effect was adopted.
            
            <figure>
            <table cellspacing="0" border="0" style="margin:auto;">
    <colgroup width="249"></colgroup>
    <colgroup width="81"></colgroup>
    <tr>
        <td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left">Model</td>
        <td style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" align="right" sdnum="2057;0;0.0">AIC</td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left"><font face="mono">is_day * time* Species * Age + (1 | id)</font></td>
        <td style="border-right: 1px solid #000000" align="right" sdval="103302.717181491" sdnum="2057;0;0.0"><font face="mono">103302.7</font></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left"><font face="mono">is_day * time * Age + (1 | id)</font></td>
        <td style="border-right: 1px solid #000000" align="right" sdval="103917.344935307" sdnum="2057;0;0.0"><font face="mono">103917.3</font></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left"><font face="mono">is_day * time + (1 | id)</font></td>
        <td style="border-right: 1px solid #000000" align="right" sdval="104179.681911522" sdnum="2057;0;0.0"><font face="mono">104179.7</font></td>
    </tr>
    <tr>
        <td style="border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left"><font face="mono">is_day * time+ Species + Age + (1 | id)</font></td>
        <td style="border-right: 1px solid #000000" align="right" sdval="104181.978374587" sdnum="2057;0;0.0"><font face="mono">104182.0</font></td>
    </tr>
    <tr>
        <td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000" height="17" align="left"><font face="mono">is_day * time + Species * Age + (1 | id)</font></td>
        <td style="border-bottom: 1px solid #000000; border-right: 1px solid #000000" align="right" sdval="104183.882536236" sdnum="2057;0;0.0"><font face="mono">104183.9</font></td>
    </tr>
</table>
            <figcaption>
                <em>Ranking of several competing models</em>.
                The AICs of each model were used to assess their respective goodness.
                The overall best model includes the interactions between all the fixed effect
                 predictor variables.
            </figcaption>
            </figure>
            Since the difference between the top model and the subsequent was large (more than 500 points), model averaging
            was not considered.
            The fact that the best model includes species and age, and their interactions, 
            indicates that both variables add some predictive power.
            </p>
        </div>
        </div>
        </div>


    </div>
    
</div>



